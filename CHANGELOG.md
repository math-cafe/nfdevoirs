# CHANGELOG

Historique des versions et √©volutions de la classe nfdevoirs.

## [2.3.0] - 2025-10-06

### üîÑ Restructuration modulaire avanc√©e

#### Technique
- **Architecture ultra-modulaire** : Division en 12 modules sp√©cialis√©s (vs 6 pr√©c√©dents) :
  - **`nf-core.sty`** : Compteurs, variables globales, utilitaires de base
  - **`nf-themes.sty`** : Syst√®me de th√®mes et palettes de couleurs
  - **`nf-layout.sty`** : Configuration de la mise en page et g√©om√©trie
  - **`nf-question.sty`** : Environnement question avec key-value et niveau de difficult√©
  - **`nf-exercice.sty`** : Environnement exercice et gestion des totaux
  - **`nf-partie.sty`** : Environnement partie avec num√©rotation hi√©rarchique
  - **`nf-devoir.sty`** : Environnement devoir principal et logique des types
  - **`nf-correction-base.sty`** : Environnement correction avec modes inline/end/only/none
  - **`nf-correction-display.sty`** : Affichage hi√©rarchique des corrections en fin
  - **`nf-bandeau.sty`** : Logique d'affichage du bandeau trois colonnes
  - **`nf-pagegarde-minimale.sty`** : Page de garde compacte pour types CONT
  - **`nf-pagegarde-complete.sty`** : Page de garde compl√®te pour types DS/EVA/DM
  - **`nf-citations.sty`** : Citations de fin de document

#### Am√©lior√©
- **Maintenabilit√© optimis√©e** : Chaque module < 150 lignes (seuil respect√©)
- **S√©paration des responsabilit√©s** : Logique claire et modules autonomes
- **Ordre de chargement** : Modules group√©s par fonction (core ‚Üí environnements ‚Üí corrections ‚Üí pages de garde)
- **Tests de validation** : Tous les modes de correction valid√©s apr√®s restructuration

#### Maintenu
- **Compatibilit√© totale** : Aucun changement d'API, fonctionnement identique
- **Performance** : Chargement optimis√© des d√©pendances

---

## [2.2.0] - 2025-10-06

### üîÑ √âvolution du syst√®me de corrections

#### Ajout√©
- **Nouveau syst√®me key-value pour les corrections** :
  - `correction=none` : Aucune correction affich√©e (nouveau d√©faut)
  - `correction=inline` : Corrections apr√®s chaque question (√©quivalent √† l'ancien `correction`)
  - `correction=end` : Corrections regroup√©es en fin (√©quivalent √† l'ancien `correctionfin`)
  - `correction=only` : Affiche uniquement les corrections, sans page de garde ni √©nonc√©

- **Migration douce** :
  - Anciens modes `correction` et `correctionfin` maintenus avec avertissements de d√©pr√©ciation
  - Messages d'avertissement explicites pour guider la migration
  - Compatibilit√© compl√®te pr√©serv√©e

#### Am√©lior√©
- **Configuration dans l'environnement devoir** : Option `correction` au niveau du document
- **Mode correction=only** : Optimis√© pour les feuilles de correction pures
- **Affichage am√©lior√©** : Titres de correction enrichis avec localisation (Partie, Exercice, Question)
- **Titre contextualis√©** : Mode `only` affiche "Corrections -- [Titre du devoir]" pour plus de clart√©
- **Masquage complet** : Mode `only` masque tout contenu d'exercice et "Fin du devoir"
- **Documentation** : Instructions compl√®tes pour la migration

#### Technique
- **Variable unifi√©e** : `\@nfcorrection` remplace les bool√©ens multiples
- **Conditionnels robustes** : Syst√®me `\expandafter\ifstrequal` pour tous les modes
- **Migration transparente** : Anciens bool√©ens pr√©serv√©s pour la compatibilit√©
- **Avertissements int√©gr√©s** : `\PackageWarning` pour guider les utilisateurs
- **Environnement exercice modernis√©** : `\NewEnviron` avec `\setbox` pour masquage en mode `only`
- **Titre dynamique** : Utilisation de `\@title` pour enrichir le mode `only`

## [2.1.0] - 2025-10-05

### üéâ Syst√®me de types de devoirs automatiques

#### Ajout√©
- **Syst√®me de types de devoirs** avec comportements automatiques :
  - `type=DS` : Devoir Surveill√© (d√©faut) - Page de garde compl√®te
  - `type=EVA` : √âvaluation - Page de garde compl√®te
  - `type=CONT` : Contr√¥le court - Page de garde minimaliste
  - `type=DM` : Devoir Maison - Page de garde compl√®te, date = remise

- **Page de garde minimaliste** pour contr√¥les courts (CONT) :
  - Bandeau simplifi√© sans logo
  - Titre simple sans ligne de s√©paration
  - Section informations compacte avec ic√¥nes
  - Bo√Æte pour notes de 2cm de hauteur
  - Trait s√©parateur, puis d√©but direct du devoir (pas de `\newpage`)

- **Adaptation automatique** selon le type :
  - **DS/EVA** : Page de garde compl√®te avec consignes d√©taill√©es
  - **CONT** : Page de garde compacte pour √©conomiser l'espace
  - **DM** : Page compl√®te avec "Remise" au lieu de "Date"

#### Technique
- **Variables de configuration** :
  - `\@nftypedevoir` : Type de devoir avec d√©faut DS
  - `\@nfpagegardetype` : Type de page de garde (complete/minimale)

- **Logique de type automatique** :
  - Fonction `\nfapplytypedefaults` avec conditionnels imbriqu√©s
  - Configuration automatique du type de page de garde selon le type
  - Override possible avec option `pagegarde=minimale|complete`

- **Impl√©mentation modulaire** :
  - Extension de `nf-core.sty` pour les nouvelles variables
  - Extension de `nf-environments.sty` pour la logique de types
  - Extension de `nf-pagegarde.sty` pour la page garde minimaliste

#### √âvolutions futures
- Type `QCM` pr√©vu pour les devoirs de style baccalaur√©at
- Architecture extensible pour de nouveaux types

---

## [2.0.0] - 2025-10-05

### üé® Breaking Changes - Syntaxe moderne et bandeau configurable

**Breaking Changes** :
- **Syntaxe questions** : `\begin{question}{points=3, bonus=2}` remplace `\begin{question}{3}{2}`
- **Option auteur** : Maintenant pour l'enseignant (bandeau), plus pour la citation

#### Ajout√©
- **Nouvelles options de configuration** :
  - `auteur={M. Dupont}` : Nom de l'enseignant (affich√© dans le bandeau)
  - `matiere={Math√©matiques}` : Mati√®re enseign√©e (affich√© dans le bandeau)
  - `bandeaupos={haut|bas|aucun}` : Position du bandeau (d√©faut: bas)

- **Bandeau d'√©tablissement en trois colonnes** :
  - **Gauche (33%)** : Logo + √âtablissement (justifi√© √† gauche)
  - **Centre (33%)** : Ann√©e scolaire (centr√©)
  - **Droite (33%)** : Auteur + Mati√®re (justifi√© √† droite)

- **Syntaxe key-value pour questions** :
  - `\begin{question}{points=3, bonus=2, niveau=4}` (remplace les param√®tres positionnels)
  - **Indicateur de difficult√©** : Syst√®me 5 √©toiles avec FontAwesome5
  - Niveaux 1-5 avec √©toiles pleines/vides color√©es

#### Am√©lior√©
- **Design √©quilibr√©** : Trois sections √©gales pour un aspect professionnel
- **Gestion intelligente** : Adaptation automatique avec/sans logo
- **Flexibilit√© de placement** : Bandeau en haut, bas ou absent selon les besoins

#### Corrig√©
- **S√©paration des r√¥les** : Option `auteur` pour l'enseignant, citation avec auteur int√©gr√©
- **Corrections non-breakable** : R√©solution des probl√®mes de saut de page
- **Typography am√©lior√©e** : Titres de parties au format "I. Titre" (vs "Partie I : Titre")
- **Gestion d'options vides** : Expansion robuste avec `\expandafter` pour tous les champs

---

## [1.3.1] - 2025-10-02

### üîÑ Restructuration majeure - Architecture modulaire

**Breaking Change** : R√©organisation compl√®te de la classe en modules sp√©cialis√©s

#### Ajout√©
- **Architecture modulaire** : Division en 6 modules ind√©pendants
  - `nf-core.sty` : Compteurs, variables globales, utilitaires de base
  - `nf-themes.sty` : Syst√®me de th√®mes et palettes de couleurs
  - `nf-layout.sty` : Configuration de la mise en page et g√©om√©trie
  - `nf-environments.sty` : Environnements principaux
  - `nf-corrections.sty` : Syst√®me de corrections et modes d'affichage
  - `nf-pagegarde.sty` : G√©n√©ration de la page de garde et citation finale

#### Am√©lior√©
- **Maintenabilit√©** : Chaque module < 150 lignes vs 504 lignes monolithiques
- **Extensibilit√©** : Ajout de fonctionnalit√©s dans des modules d√©di√©s
- **Lisibilit√©** : S√©paration claire des responsabilit√©s
- **Documentation** : Instructions d√©taill√©es pour le d√©veloppement

#### Maintenu
- **Compatibilit√© compl√®te** : API inchang√©e, m√™me utilisation
- **Fonctionnalit√©s** : Toutes les fonctionnalit√©s pr√©c√©dentes pr√©serv√©es

---

## [1.3.0] - 2025-10-02

### üé® Syst√®me de th√®mes extensible

#### Ajout√©
- **Syst√®me de th√®mes** avec architecture extensible
- **5 palettes de couleurs** :
  - `theme=moderne` (d√©faut) : Palette bleue professionnelle
  - `theme=nb` : D√©grad√©s de gris optimis√©s pour impression monochrome
  - `theme=orange` : Palette chaleureuse et √©nergique (orange/ambre/cr√®me)
  - `theme=vert` : Palette nature et √©cologique (vert sapin/menthe)
  - `theme=violet` : Palette cr√©ative et moderne (violet profond/clair/lavande)

#### Am√©lior√©
- **Nomenclature s√©mantique** des couleurs (`nfcolpartie`, `nfcolexercice`, etc.)
- **Optimisation impression** : Th√®mes con√ßus pour √™tre lisibles en N&B
- **Documentation** : Instructions pour cr√©er de nouveaux th√®mes

#### Technique
- Syst√®me de bool√©ens mutuellement exclusifs
- Palettes conditionnelles avec fallback robuste
- Documentation int√©gr√©e pour l'extension

---

## [1.2.0] - 2025-10-02

### üìÑ Page de garde et corrections avanc√©es

#### Ajout√©
- **Page de garde automatique** compl√®te :
  - En-t√™te styl√© avec titre et informations √©l√®ve/classe
  - Section bar√®me/dur√©e/date avec colonnes adaptatives
  - Bo√Æte vide pour notes et observations de l'enseignant
  - Consignes d√©taill√©es et conseils p√©dagogiques
  - Easter egg optionnel int√©gr√© dans les consignes

- **Mode de correction `correctionfin`** :
  - Stockage des corrections avec compteurs et macros
  - R√©f√©rencement automatique (Partie X, Exercice Y, Question Z)
  - Affichage group√© en fin de document

- **Option `duree`** pour l'environnement devoir

#### Am√©lior√©
- **Mise en page** : Abandon du syst√®me marginpar pour colonnes robuste
- **Pagination** : Num√©rotation "n/total" avec fancyhdr
- **Points** : Affichage dans colonne d√©di√©e (2,5cm) plus stable
- **Marges** : Optimisation pour impression (10mm partout sauf bas 15mm)

#### Technique
- Package `environ` pour capturer le contenu des corrections
- Syst√®me de stockage des corrections avec `\csname`
- Gestion propre des √©tats avec bool√©ens

---

## [1.1.0] - 2025-10-02

### üõ†Ô∏è Am√©lioration de l'outillage

#### Ajout√©
- **Documentation enrichie** :
  - `CLAUDE.md` : Instructions pour Claude Code
  - Commentaires d√©taill√©s dans `.latexmkrc` et `Makefile`
  - Structure organis√©e avec sections d√©limit√©es

#### Am√©lior√©
- **Makefile** :
  - Messages informatifs avec emojis
  - Gestion d'erreurs am√©lior√©e pour `make log`
  - Documentation compl√®te avec exemples

- **Configuration latexmk** :
  - Explications d√©taill√©es de chaque option
  - Commentaires pratiques pour l'adaptation
  - Correction du mode watch par d√©faut

#### Corrig√©
- **Mode build** : `make build` ne lance plus le mode watch automatiquement
- **Mode watch** : Activation uniquement via `make watch` ou `latexmkrc -pvc`

---

## [1.0.0] - 2025-09-29

### üéâ Version initiale

#### Fonctionnalit√©s de base
- **Environnements structur√©s** :
  - `devoir` : Conteneur principal avec m√©tadonn√©es
  - `partie` : Sections du document avec num√©rotation romaine
  - `exercice` : Blocs d'exercices num√©rot√©s
  - `question` : Questions avec points bar√®me et bonus

- **Gestion automatique des points** :
  - Calcul des totaux par exercice, partie et devoir
  - Affichage dans la marge droite
  - Syst√®me de double compilation via fichier .aux

- **Syst√®me de corrections** :
  - Mode `correction` : Affichage inline apr√®s chaque question
  - Bo√Ætes color√©es avec tcolorbox
  - Style coh√©rent et lisible

- **Configuration** :
  - Support LuaLaTeX avec fontspec
  - Packages math√©matiques (amsmath, amssymb, amsthm)
  - Configuration fran√ßaise avec babel
  - G√©om√©trie de page adapt√©e

- **Outillage** :
  - Makefile pour automatisation
  - Configuration latexmkrc optimis√©e
  - Support evince pour visualisation

#### Architecture technique
- Classe bas√©e sur `article`
- Compteurs hi√©rarchiques automatiques
- Macros auxiliaires pour r√©cup√©ration des points
- Variables globales pour m√©tadonn√©es du devoir

---

## L√©gende des types de changements

- üéâ **Nouvelle fonctionnalit√© majeure**
- üîÑ **Restructuration/Refactoring**
- üé® **Am√©liorations visuelles/th√®mes**
- üìÑ **Documentation/Contenu**
- üõ†Ô∏è **Outils/Configuration**
- üêõ **Corrections de bugs**
- ‚ö° **Am√©liorations de performance**
- üîí **S√©curit√©**

## Format des versions

Le projet suit le [Semantic Versioning](https://semver.org/) :
- **MAJOR.MINOR.PATCH**
- **MAJOR** : Changements incompatibles (breaking changes)
- **MINOR** : Nouvelles fonctionnalit√©s compatibles
- **PATCH** : Corrections de bugs compatibles